# Copyright Utrecht University

- name: Configure cronjob to update resource storage data
  become_user: "{{ irods_service_account }}"
  become: true
  ansible.builtin.cron:
    name: 'update-ufs-resources.py'
    minute: '*'
    hour: '*'
    job: >
      /usr/bin/python /etc/irods/yoda-ruleset/tools/update-ufs-resources.py
      -e "{{ irods_arb_exempt_resources }}"
      update
      --min-percent-free "{{ irods_arb_min_percent_free }}"
      --min-gb-free "{{ irods_arb_min_gb_free }}"
      >& /dev/null
    state: '{{ "present" if irods_arb_enabled else "absent" }}'
