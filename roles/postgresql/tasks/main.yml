---
# copyright Utrecht University

- name: Collect package facts
  ansible.builtin.package_facts:
    manager: auto


- name: Setup PostgreSQL using legacy native distribution packages
  ansible.builtin.include_tasks: main_legacy.yml
  when: postgresql_use_native_packages


- name: Setup PostgreSQL using PostgreSQL packages
  ansible.builtin.include_tasks: main_new.yml
  when: not postgresql_use_native_packages


- name: Set Postgresqltuner directory for legacy native distribution
  ansible.builtin.set_fact:
    postgresqltuner_dir: /var/lib/pgsql
  when: postgresql_use_native_packages


- name: Install postgresqltuner
  ansible.builtin.include_tasks: install-postgresqltuner.yml
  when: yoda_environment == "development" or yoda_environment == "testing"
