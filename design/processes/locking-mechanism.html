

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/yoda/assets/css/just-the-docs-default.css">
  
  <style type="text/css">
.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:not(.external):nth-child(3) > .nav-list > .nav-list-item:nth-child(4) > .nav-list > .nav-list-item:nth-child(3) > .nav-list-link { display: block; font-weight: 600; text-decoration: none; background-image: linear-gradient(-90deg, #201f23 0%, rgba(32, 31, 35, 0.8) 80%, rgba(32, 31, 35, 0) 100%); }

.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:nth-child(3) > .nav-list-expander svg, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:nth-child(3) > .nav-list > .nav-list-item:nth-child(4) > .nav-list-expander svg { transform: rotate(-90deg); }
.site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:nth-child(3) > .nav-list, .site-nav > .nav-list:nth-child(1):not(.nav-category-list) > .nav-list-item:nth-child(3) > .nav-list > .nav-list-item:nth-child(4) > .nav-list { display: block; }

.site-nav > .nav-category-list > .nav-list-item > .nav-list-expander svg { transform: rotate(-90deg); }
.site-nav > .nav-category-list > .nav-list-item > .nav-list { display: block; }

</style>


  

  
    <script src="/yoda/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/yoda/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="icon" href="/yoda/favicon.ico" type="image/x-icon">



  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Folder Locking mechanism | Yoda</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Folder Locking mechanism" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="On this website you can find release notes and technical documentation on software design and administration tasks of Yoda" />
<meta property="og:description" content="On this website you can find release notes and technical documentation on software design and administration tasks of Yoda" />
<meta property="og:site_name" content="Yoda" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Folder Locking mechanism" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"On this website you can find release notes and technical documentation on software design and administration tasks of Yoda","headline":"Folder Locking mechanism","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/yoda/yoda.svg"}},"url":"/yoda/design/processes/locking-mechanism.html"}</script>
<!-- End Jekyll SEO tag -->


  

</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="/yoda/" class="site-title lh-tight">
  <div class="site-logo" role="img" aria-label="Yoda"></div>

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </button>
  </div>
  <nav aria-label="Main" id="site-nav" class="site-nav">
    
    
      <ul class="nav-list"><li class="nav-list-item"><a href="/yoda/" class="nav-list-link">Home</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Release Notes category" aria-pressed="false">
      <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
    </button><a href="/yoda/release-notes/" class="nav-list-link">Release Notes</a><ul class="nav-list"><li class="nav-list-item"><a href="/yoda/release-notes/release-1.9.html" class="nav-list-link">v1.9</a></li><li class="nav-list-item"><a href="/yoda/release-notes/release-1.8.html" class="nav-list-link">v1.8</a></li><li class="nav-list-item"><a href="/yoda/release-notes/release-1.7.html" class="nav-list-link">v1.7</a></li><li class="nav-list-item"><a href="/yoda/release-notes/release-1.6.html" class="nav-list-link">v1.6</a></li><li class="nav-list-item"><a href="/yoda/release-notes/release-1.5.html" class="nav-list-link">v1.5</a></li><li class="nav-list-item"><a href="/yoda/release-notes/release-1.4.html" class="nav-list-link">v1.4</a></li><li class="nav-list-item"><a href="/yoda/release-notes/release-1.3.html" class="nav-list-link">v1.3</a></li><li class="nav-list-item"><a href="/yoda/release-notes/release-1.2.html" class="nav-list-link">v1.2</a></li><li class="nav-list-item"><a href="/yoda/release-notes/release-1.1.html" class="nav-list-link">v1.1</a></li><li class="nav-list-item"><a href="/yoda/release-notes/release-1.0.html" class="nav-list-link">v1.0</a></li><li class="nav-list-item"><a href="/yoda/release-notes/release-0.9.7.html" class="nav-list-link">v0.9.7</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Software Design category" aria-pressed="false">
      <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
    </button><a href="/yoda/design/" class="nav-list-link">Software Design</a><ul class="nav-list"><li class="nav-list-item"><a href="/yoda/design/api/" class="nav-list-link">API</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in System Overview category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/yoda/design/overview/" class="nav-list-link">System Overview</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/yoda/design/overview/research-space.html" class="nav-list-link">Research space</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/vault-space.html" class="nav-list-link">Vault space</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/group-manager.html" class="nav-list-link">Group manager</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/statistics.html" class="nav-list-link">Statistics module</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/deposit-space.html" class="nav-list-link">Deposit space</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/statistics_1.8.html" class="nav-list-link">Statistics module (v1.8 or earlier)</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/theme-packages.html" class="nav-list-link">Theme packaging</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/intake.html" class="nav-list-link">Intake module</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/vault-archive.html" class="nav-list-link">Vault archive</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/data-requests.html" class="nav-list-link">Data requests module</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/authentication.html" class="nav-list-link">Authentication</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/data_package_reference.html" class="nav-list-link">Data Package Reference</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/deployment.html" class="nav-list-link">Deployment</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/external-user-service.html" class="nav-list-link">External User Service</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/overview/yoda-moai.html" class="nav-list-link">Yoda MOAI service</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Metadata category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/yoda/design/metadata/" class="nav-list-link">Metadata</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/yoda/design/metadata/adr-schema-identifiers.html" class="nav-list-link">Architectural decision record schema identifier format</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/metadata/metadata-form-json.html" class="nav-list-link">Metadata JSON schema</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/metadata/metadata-form.html" class="nav-list-link">Metadata form implementation</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/metadata/schema-configuration.html" class="nav-list-link">Metadata schemas</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/metadata/metadata-vault.html" class="nav-list-link">Metadata vault</a>
              </li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Processes category" aria-pressed="false">
            <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
          </button><a href="/yoda/design/processes/" class="nav-list-link">Processes</a><ul class="nav-list"><li class="nav-list-item">
                <a href="/yoda/design/processes/async-system-execution.html" class="nav-list-link">Asynchronous and Privileged Execution</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/processes/asynchronous-processes.html" class="nav-list-link">Asynchronous processes</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/processes/locking-mechanism.html" class="nav-list-link">Folder Locking mechanism</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/processes/publication-process.html" class="nav-list-link">Publication Process</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/processes/revisions.html" class="nav-list-link">Revision management</a>
              </li><li class="nav-list-item">
                <a href="/yoda/design/processes/vault-process.html" class="nav-list-link">To vault process in research module</a>
              </li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Administration Tasks category" aria-pressed="false">
      <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
    </button><a href="/yoda/administration/" class="nav-list-link">Administration Tasks</a><ul class="nav-list"><li class="nav-list-item"><a href="/yoda/administration/configuring-yoda.html" class="nav-list-link">Configuring Yoda</a></li><li class="nav-list-item"><a href="/yoda/administration/deploying-yoda.html" class="nav-list-link">Deploying Yoda</a></li><li class="nav-list-item"><a href="/yoda/administration/hotfixing-ruleset.html" class="nav-list-link">Hotfixing ruleset</a></li><li class="nav-list-item"><a href="/yoda/administration/local-ruleset-patch.html" class="nav-list-link">Local ruleset patches</a></li><li class="nav-list-item"><a href="/yoda/administration/installing-licenses.html" class="nav-list-link">Installing Licenses</a></li><li class="nav-list-item"><a href="/yoda/administration/installing-terms.html" class="nav-list-link">Installing Terms & Conditions</a></li><li class="nav-list-item"><a href="/yoda/administration/installing-preservable-file-formats.html" class="nav-list-link">Installing lists of preservable file formats</a></li><li class="nav-list-item"><a href="/yoda/administration/installing-metadata-schemas.html" class="nav-list-link">Installing metadata schemas</a></li><li class="nav-list-item"><a href="/yoda/administration/local-postfix-mta.html" class="nav-list-link">Local Postfix MTA</a></li><li class="nav-list-item"><a href="/yoda/administration/installing-datarequest-module.html" class="nav-list-link">Installing datarequest module</a></li><li class="nav-list-item"><a href="/yoda/administration/upgrading-metadata-schemas.html" class="nav-list-link">Upgrading metadata schemas</a></li><li class="nav-list-item"><a href="/yoda/administration/troubleshooting-publication.html" class="nav-list-link">Troubleshooting publication</a></li><li class="nav-list-item"><a href="/yoda/administration/using-python-irodsclient.html" class="nav-list-link">Using the python-irodsclient API</a></li><li class="nav-list-item"><a href="/yoda/administration/troubleshooting-email.html" class="nav-list-link">Troubleshooting email</a></li><li class="nav-list-item"><a href="/yoda/administration/upgrading-postgresql.html" class="nav-list-link">Upgrading PostgreSQL</a></li><li class="nav-list-item"><a href="/yoda/administration/configuring-openidc.html" class="nav-list-link">Configuring OIDC</a></li><li class="nav-list-item"><a href="/yoda/administration/troubleshooting-replication-revisions.html" class="nav-list-link">Troubleshooting replication and revision creation</a></li><li class="nav-list-item"><a href="/yoda/administration/configuring-cleanup-temporary-files.html" class="nav-list-link">Configuring cleanup functionality temporary files</a></li><li class="nav-list-item"><a href="/yoda/administration/configuring-data-access-passwords.html" class="nav-list-link">Configuring Data Access Passwords</a></li><li class="nav-list-item"><a href="/yoda/administration/restore-collection.html" class="nav-list-link">Restore collection</a></li><li class="nav-list-item"><a href="/yoda/administration/setting-job-flags.html" class="nav-list-link">Setting job flags</a></li><li class="nav-list-item"><a href="/yoda/administration/supported-distributions.html" class="nav-list-link">Supported distributions</a></li><li class="nav-list-item"><a href="/yoda/administration/deprovision-users.html" class="nav-list-link">Deprovision users</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Development category" aria-pressed="false">
      <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
    </button><a href="/yoda/development/" class="nav-list-link">Development</a><ul class="nav-list"><li class="nav-list-item"><a href="/yoda/development/setting-up-development-environment.html" class="nav-list-link">Setting up development environment</a></li><li class="nav-list-item"><a href="/yoda/development/docker-setup.html" class="nav-list-link">Running Yoda using Docker Compose</a></li><li class="nav-list-item"><a href="/yoda/development/running-api-ui-tests.html" class="nav-list-link">Running API and UI tests</a></li><li class="nav-list-item"><a href="/yoda/development/yodadrive-development-environment.html" class="nav-list-link">Setting up YodaDrive development environment</a></li><li class="nav-list-item"><a href="/yoda/development/mock_tape_archive.html" class="nav-list-link">Mock tape archive</a></li><li class="nav-list-item"><a href="/yoda/development/development-tips.html" class="nav-list-link">Development tips</a></li><li class="nav-list-item"><a href="/yoda/development/wall-of-fame.html" class="nav-list-link">Wall of Fame</a></li></ul></li></ul>

    
  </nav>

  
  
    <footer class="site-footer">&copy; 2017-2023 <a href="https://www.uu.nl/" title="Utrecht University website">Utrecht University</a></footer>

  
</div>

  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Yoda" aria-label="Search Yoda" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
    <nav aria-label="Auxiliary" class="aux-nav">
  <ul class="aux-nav-list">
    
      <li class="aux-nav-list-item">
        <a href="https://github.com/UtrechtUniversity/yoda" class="site-button"
          
        >
          Yoda on GitHub
        </a>
      </li>
    
  </ul>
</nav>

  
</div>

    <div class="main-content-wrap">
      <nav aria-label="Breadcrumb" class="breadcrumb-nav">
  <ol class="breadcrumb-nav-list">
  
    <li class="breadcrumb-nav-list-item"><a href="/yoda/design/">Software Design</a></li>
    <li class="breadcrumb-nav-list-item"><a href="/yoda/design/processes/">Processes</a></li>
  <li class="breadcrumb-nav-list-item"><span>Folder Locking mechanism</span></li>
  </ol>
</nav>
      <div id="main-content" class="main-content">
        <main>
          
            <h1 id="folder-locking-mechanism">
  
  
    <a href="#folder-locking-mechanism" class="anchor-heading" aria-labelledby="folder-locking-mechanism"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Folder Locking mechanism
  
  
</h1>
    
<p>To prevent modification of a folder in the research area, a researcher can use the lock function. This will catch attempts to write or remove data to that folder
until the folder is unlocked again. The same mechanism is used to prevent modification during the status transitions needed to put a folder in to the vault. The
iRODS ACL system could not be used, because researcher should be able to lock/unlock a folder themselves and not rely on an administrator to do so. This document describes
the technical implementation of the locking mechanism in the research ruleset.</p>

<p>Locks are represented by metadata on the folder, it’s children and it’s parents. The lock consists of a AVU with org_lock (defined in iiConstants.r) as attribute name and the collection where
the lock is started (rootCollection). Whenever a lock is set this AVU is put on every child using a treewalk and every parent using iteration until the <code class="language-plaintext highlighter-rouge">/{rodsZone}/home/research-{groupName}</code> collection is found. Every relevant static Policy Enforcement Point that could be triggered because of a modification in the research area is checked for the metadata and in general the following rules are enforced:</p>

<ul>
  <li>if the root collection of the lock is on the current collection or a parent collection disallow the action.</li>
  <li>if the root collection of the lock is on a child collection allow modification of data objects, but disallow renames of parent collections.</li>
</ul>

<p>In case there is a source and destination object, both need to be checked for locks and the following rules apply:</p>

<ul>
  <li>if the source is locked, but the destination is not then disallow move operations, but allow copy operations.</li>
  <li>if the destination is locked, disallow every action.</li>
</ul>

<p>msiOprDisallowed and msiDeleteDisallowed are used to stop the current operation and return an error to the clients.
There is one unfortunate special case. There is no static PEP for preconditions on a file put operation, only a post PEP. To prevent
users from putting new files into a locked collection the files are removed in the post condition <code class="language-plaintext highlighter-rouge">acPostProcForPut</code>. When using webDAV it may appear like the file is still there due to caching.</p>
<h2 id="setting-and-removing-locks">
  
  
    <a href="#setting-and-removing-locks" class="anchor-heading" aria-labelledby="setting-and-removing-locks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Setting and removing locks
  
  
</h2>
    
<p>The locks are set and removed with the iiFolderLockChange rule in the iiFolderStatusTransition.r file.
This rule should not be directly run, but triggered from folder status transitions.
Please refer to the folder status design document for details on which transition should lock the folder.
The rules in iiFolderStatusTransitions.r called by the front-end to initiate a status change will attempt a metadata change on the <code class="language-plaintext highlighter-rouge">org_status</code> attribute.
This will trigger an metadata PEP, which will run the lock change when the current user is allowed to.
Every folder status transition is checked for preconditions by the iiCanModifyFolderStatus rule in iiPolicyChecks.r.</p>

<p>When the locking fails, the modification of the <code class="language-plaintext highlighter-rouge">org_status</code> change will be interrupted by calling msiOprDisallowed.
For the rules called by the front-end the errors are caught and returned with statusInfo.</p>

          

          
        </main>
        

  <hr>
  <footer>
    

    <p class="text-small text-grey-dk-100 mb-0">Licensed under <a href="https://github.com/UtrechtUniversity/yoda/blob/development/LICENSE">GPLv3</a>.</p>

    
      <div class="d-flex mt-2">
        
        
          <p class="text-small text-grey-dk-000 mb-0">
            <a href="https://github.com/UtrechtUniversity/yoda/tree/development/docs/design/processes/locking-mechanism.md" id="edit-this-page">Edit this page on GitHub.</a>
          </p>
        
      </div>
    
  </footer>


      </div>
    </div>
    
      

<div class="search-overlay"></div>

    
  </div>

  
</body>
</html>

