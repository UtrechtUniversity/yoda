<!DOCTYPE html>
<html lang="en">
    <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <link rel="icon" href="/yoda/assets/images/favicon.ico">

  <title>Statistics module</title>

  <link rel='stylesheet' id='bootstrap-css'  href='//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css' type='text/css' media='all' />
  <link rel="stylesheet" href="/yoda/assets/css/style.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="/yoda/assets/css/custom.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="/yoda/assets/css/print.css" type="text/css" media="print" />
</head>

    <body data-rsssl="1" class="page-template-default page page-id-6 page-parent" data-spy="scroll" data-target="#sidebarnav">
        <div id="page">

            <div id="brandbar" class="affix-top">
    <div class="container">
        <div class="row">
            <div class="col-sm-4 col-xs-8 logodiv">
                <button type="button" class="navbar-toggle hidden-print" data-toggle="collapse" data-target="#main-menu-collapse">
                    <span class="sr-only">Navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="https://www.uu.nl/en">
                    <img src="/yoda/assets/images/uu-logo.svg" alt="Logo Utrecht University">
                </a>

                <div class="visible-print-block">
                    <h1>YODA</h1>
                </div>
            </div>

            <div class="col-sm-6 col-xs-4 hidden-print" role="search">
                <!--
                <div class="pull-right">
                    <form method="get" id="searchform" action="https://yoda.sites.uu.nl">
                        <div class="search-wrapper">
                            <label class="screen-reader-text" for="s">'</label>
                            <input type="text" class="searchfield" value="" name="s" id="s" placeholder="Search the Site...">
                            <input type="submit" id="searchsubmit" class="searchbutton" value="">
                        </div>
                    </form>
                </div>
                -->
            </div>
        </div>
    </div>
</div>
<header id="masthead" class="header hidden-print">
    <div class="container">
        <h1>
            <a href="/yoda" rel="home" title="YODA">
                YODA
            </a>
        </h1>
    </div>
</header>

<a class="skip-link sr-only" href="#content">Skip to content</a>

<!-- MAIN MENU -->
<nav id="#access" class="navbar navbar-default navbar-inverse">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="container">
        <div class="navbar-header"></div>
        <div id="main-menu-collapse" class="collapse navbar-collapse">
            <ul id="menu-hoofdmenu" class="nav navbar-nav">
                
                
                
                <li class="first-item menu-item menu-item-type-post_type menu-item-object-page dropdown">
                    <a title="Release notes" href="/yoda/release-notes/index.html">Release notes</a>
                    
                    
                    
                    <ul class="submenu visible-xs visible-sm nav navbar-nav">
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Release 1.7" href="/yoda/release-notes/release-1.7.html">
                                Release 1.7
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Release 1.6" href="/yoda/release-notes/release-1.6.html">
                                Release 1.6
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Release 1.5" href="/yoda/release-notes/release-1.5.html">
                                Release 1.5
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Release 1.4" href="/yoda/release-notes/release-1.4.html">
                                Release 1.4
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Release 1.3" href="/yoda/release-notes/release-1.3.html">
                                Release 1.3
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Release 1.2" href="/yoda/release-notes/release-1.2.html">
                                Release 1.2
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Release 1.1" href="/yoda/release-notes/release-1.1.html">
                                Release 1.1
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Release 1.0" href="/yoda/release-notes/release-1.0.html">
                                Release 1.0
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Release 0.9.7" href="/yoda/release-notes/release-0.9.7.html">
                                Release 0.9.7
                            </a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                
                <li class="first-item menu-item menu-item-type-post_type menu-item-object-page dropdown">
                    <a title="Administration" href="/yoda/administration/index.html">Administration</a>
                    
                    
                    
                    <ul class="submenu visible-xs visible-sm nav navbar-nav">
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Installing Licenses" href="/yoda/administration/installing-licenses.html">
                                Installing Licenses
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Installing terms" href="/yoda/administration/installing-terms.html">
                                Installing terms
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Installing metadata schemas" href="/yoda/administration/installing-metadata-schemas.html">
                                Installing metadata schemas
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Upgrading metadata schemas" href="/yoda/administration/upgrading-metadata-schemas.html">
                                Upgrading metadata schemas
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Troubleshooting publication" href="/yoda/administration/troubleshooting-publication.html">
                                Troubleshooting publication
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Restore collection" href="/yoda/administration/restore-collection.html">
                                Restore collection
                            </a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                
                <li class="first-item menu-item menu-item-type-post_type menu-item-object-page dropdown">
                    <a title="Development" href="/yoda/development/index.html">Development</a>
                    
                    
                    
                    <ul class="submenu visible-xs visible-sm nav navbar-nav">
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Setting up development environment" href="/yoda/development/setting-up-development-environment.html">
                                Setting up development environment
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Development environment test users and data" href="/yoda/development/development-test-data.html">
                                Development environment test users and data
                            </a>
                        </li>
                        
                    </ul>
                    
                </li>
                
                
                <li class="first-item menu-item menu-item-type-post_type menu-item-object-page dropdown">
                    <a title="Software design" href="/yoda/design/index.html">Software design</a>
                    
                    
                    
                    <ul class="submenu visible-xs visible-sm nav navbar-nav">
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="System overview" href="/yoda/design/system-overview.html">
                                System overview
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Research space" href="/yoda/design/research-space.html">
                                Research space
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Vault space" href="/yoda/design/vault-space.html">
                                Vault space
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Asynchronous and privileged execution" href="/yoda/design/async-system-execution.html">
                                Asynchronous and privileged execution
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="External user service" href="/yoda/design/external-user-service.html">
                                External user service
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Group manager" href="/yoda/design/group-manager.html">
                                Group manager
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Locking mechanism" href="/yoda/design/locking-mechanism.html">
                                Locking mechanism
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Metadata form" href="/yoda/design/metadata-form.html">
                                Metadata form
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Publication process" href="/yoda/design/publication-process.html">
                                Publication process
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Python plugin" href="/yoda/design/python-plugin.html">
                                Python plugin
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown current-menu-item">
                            <a title="Statistics module" href="/yoda/design/statistics.html">
                                Statistics module
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Revision management" href="/yoda/design/revisions.html">
                                Revision management
                            </a>
                        </li>
                        
                        
                        <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children dropdown">
                            <a title="Vault process" href="/yoda/design/vault-process.html">
                                Vault process
                            </a>
                        </li>
                        
                    </ul>
                    
                </li>
                
            </ul>
        </div>
    </div>
</nav>
<!-- /MAIN MENU -->


            <div id="content" class="two-col">
                <header class="article-header article-header-main">
                    <div class="header-image hidden-print">

                        
                        <div class="breadcrumbs" xmlns:v="https://rdf.data-vocabulary.org/#">
                            <div class="container">
							<span property="itemListElement" typeof="ListItem">
								<span property="name">YODA</span>
								<meta property="position" content="1">
							</span>
                            </div>
                        </div>
                        

                        <img src="/yoda/assets/images/header.jpg" alt="">

                        
                        <div class="page-header-placeholder"></div>
                        
                    </div>
                </header>

                <div id="content-wrapper" class="container">
                    <div class="row-offcanvas row-offcanvas-left">
                        <div id="left-sidebar" class="sidebar-offcanvas clearfix hidden-print" role="complementary">
                            <!-- PAGE MENU -->
                            
                            
                            
                            <div class="widget-1 first-widget widget widget_nav_menu">
                                <h4 class="widgettitle">Menu</h4>
                                <div class="menu-hoofdmenu-container">
                                    <!-- PAGE MENU -->
                                    <ul class="menu">
                                        
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                                                <a href="/yoda/design/system-overview.html">System overview</a>
                                            </li>
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                                                <a href="/yoda/design/research-space.html">Research space</a>
                                            </li>
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                                                <a href="/yoda/design/vault-space.html">Vault space</a>
                                            </li>
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                                                <a href="/yoda/design/async-system-execution.html">Asynchronous and privileged execution</a>
                                            </li>
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                                                <a href="/yoda/design/external-user-service.html">External user service</a>
                                            </li>
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                                                <a href="/yoda/design/group-manager.html">Group manager</a>
                                            </li>
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                                                <a href="/yoda/design/locking-mechanism.html">Locking mechanism</a>
                                            </li>
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                                                <a href="/yoda/design/metadata-form.html">Metadata form</a>
                                            </li>
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                                                <a href="/yoda/design/publication-process.html">Publication process</a>
                                            </li>
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                                                <a href="/yoda/design/python-plugin.html">Python plugin</a>
                                            </li>
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children current-menu-item">
                                                <a href="/yoda/design/statistics.html">Statistics module</a>
                                            </li>
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                                                <a href="/yoda/design/revisions.html">Revision management</a>
                                            </li>
                                        
                                            
                                            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children">
                                                <a href="/yoda/design/vault-process.html">Vault process</a>
                                            </li>
                                        
                                    </ul>
                                </div>
                            </div>
                            
                            <!-- /PAGE MENU -->
                        </div>

                        <div class="page-content clearfix">
                            
                            <div class="page-title">
                                <h1>
                                    Statistics module
                                </h1>
                            </div>
                            
			    <!--
                            <div class="toggle-btn-div visible-xs clearfix">
                                <button type="button" class="toggle-btn white button icon left arrow-right" data-toggle="offcanvas">
                                    Show sidebar
                                </button>
                            </div>
                            -->
                            <div class="page-content-inner facetwp-template">

                                <article id="post-6" class="clearfix post-6 page type-page status-publish hentry first-post">
                                    <section class="entry-content">
                                        <h1 id="statistics-module">Statistics module</h1>

<h2 id="resources-and-tiers">Resources and tiers</h2>
<p>Any resources can be administratively assigned to one tier.
A tier is an ilab-application introduced entity, not standard iRODS
A tier can be considered a price level of a resource.</p>

<p>metadata on resource level:<code class="language-plaintext highlighter-rouge">org_storage_tier  = ‘tape’</code></p>

<p>If no tier is assigned to a resource yet, this is considered the ‘Standard’ tier by default.</p>

<h2 id="registering-usage-data">Registering usage data</h2>
<p>Once a month a cronjob registers storage data for each category, based upon each group in the category.
Collection of storage amount is performed  per group and per storage tier and stored as metadata on corresponding group.</p>

<p>All determined storage data is recorded on group level.
Each group holds the following metadata with key: <code class="language-plaintext highlighter-rouge">org_storage_data_month</code>.</p>

<p>This is postfixed with the month number, like:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>org_storage_data_month01
org_storage_data_month02
org_storage_data_month03
org_storage_data_month04
org_storage_data_month05
org_storage_data_month06
org_storage_data_month07
org_storage_data_month08
org_storage_data_month09
org_storage_data_month10
org_storage_data_month11
org_storage_data_month12
</code></pre></div></div>
<p>Thus creating a full year cyclic buffer.</p>

<p>Per entry, i.e. for a group every month, each metadata-entry holds category, tier and  storage information in a JSON format <code class="language-plaintext highlighter-rouge">['Categoryname', 'Tiername', '100']</code>.
The frontend steps into this cyclic buffer starting from current month backward.
Per month the front end gets tiername and storage data in a total array divided in
tiername, months and storage.</p>

<p>Metadata attribute:
<code class="language-plaintext highlighter-rouge">UUORGMETADATAPREFIX ++ 'storage_data_month' ++ *month;</code></p>

<p>Metadata value:
<code class="language-plaintext highlighter-rouge">*json_str = "[\"*category\", \"*tier\", \"*storageAmount\"]";</code></p>

<p>The corresponding category is registered on group level as well as a group could possibly change category. So for historic purposes it is required to know to what category a group belonged.</p>

<h2 id="twelve-month-registration">Twelve month registration</h2>
<p>Per group one or more metadata attributes like this exist for a month.<br />
This occurs for each month (<code class="language-plaintext highlighter-rouge">org_storageDataMonth01, … , org_storageDataMonth12</code>) thus setting up a cyclic buffer for registration with a maximum history  12 months history.
After 12 months the previous values are overwritten automatically by the mothly cronjob.</p>

<h2 id="collecting-data-for-reporting">Collecting data for reporting</h2>
<p>To find all latest and historic data for a category metadata can be matched against <code class="language-plaintext highlighter-rouge">‘[\“’ ++ *cat ++ ‘\”%%’</code>.
This wil bring up all metadata storage metadata for this category. Combined with a specific month this will bring up all required data to calculate  the storage per tier for a specific category for a month.</p>

<h2 id="which-month-does-registered-data-belong-to">Which month does registered data belong to?</h2>
<p>For now, when registration takes place after the 15th of a month, the data collected is linked to the month later.
I.e. data collected on 27th of may is linked to the month of June. And therefore registered under <code class="language-plaintext highlighter-rouge">org_storage_data_month06</code>.
This as invoicing takes place in June over the month of may.</p>

                                    </section>

                                    <footer class="article-footer"></footer>
                                </article>
                            </div> <!-- /page-content-inner -->
                        </div> <!-- /page-content -->
                    </div> <!--row-offcanvas -->
                </div> <!-- /#content-wrapper -->
            </div>

            <footer id="colophon" class="footer hidden-print">
                <div id="inner-footer" class="container clearfix">
                    <div class="row">
                        <div class="col-sm-6">
                            <img alt="Logo Utrecht University" src="/yoda/assets/images/uu-logo-footer.svg">
                        </div>
                        <div class="col-sm-6">
                            <p class="source-org copyright pull-right">© 2020 Utrecht University, <a href="https://www.uu.nl/en/organisation/contact/disclaimer">disclaimer</a></p>
                        </div>
                    </div>
                </div>
            </footer>

            <p id="back-top" style="display: none;">
                <a href="#top"><i class="fa fa-angle-up"></i></a>
            </p>

            <script type="text/javascript" src='/yoda/assets/js/jquery.js'></script>
<script type="text/javascript" src='/yoda/assets/js/bootstrap.min.js'></script>
        </div>
    </body>
</html>
